<% if current_user %>

  <%= link_to 'New Picture', new_picture_path %>

  <p><%= link_to destroy_user_session_path, method: :delete do %>
    Log Out
  <% end %></p>

  <h1>Hello, <%= current_user.name %>!</h1>

  <% @pictures.each do |picture| %>
    Posted by: <%= picture.user.name %>
    <br>
    Posted on: <%= picture.created_at.strftime('%d/%m/%Y %H:%M')%>
    <br>
    <%= link_to picture_path(picture.id) do %>
      <%= image_tag picture.image_url, alt: "image" %>
    <% end %>
    <br>
    <br>

    <h3>Comment on This Picture</h3>
    <%= form_for [picture, Comment.new] do |f| %>
      <%= f.text_area :text %><br>
      <%= f.hidden_field :picture_id, value: picture.id %>
      <%= f.submit %>
    <% end %>

    <h3>Comments:</h3>

      <% picture.comments.each do |comment| %>
        <div class="comment">
          Comment by: <%= comment.user.name %>
          <br>
          Commented on: <%= comment.created_at.strftime('%d/%m/%Y %H:%M')%>
          <br>
          <%= comment.text %>
          <br>
          <% if comment.user_id == current_user.id %>
            <%= link_to 'Destroy', picture_comment_path(picture, comment), method: :delete, data: { confirm: 'Are you sure?' } %>
            <%= link_to 'Edit', edit_picture_comment_path(picture, comment), method: :get %>
          <% end %>
        </div>
      <% end %>

  <% end %>

<% end %>
